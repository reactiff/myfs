<!DOCTYPE html>
<html>
<head>
	<meta name="viewport" content="initial-scale=1.0, width=device-width, height=device-height, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
	<link rel="stylesheet" href="/css/flex.css" />
	<link rel="stylesheet" href="/css/orthogonal.css" />
	<link rel="stylesheet" href="/css/snap-scroll.css" />
</head>
<body>
	<pre id="code"></pre>
	<div id="root"></div>
</body>
<script type="text/javascript" src="/js/e.js"></script>
<script type="text/javascript" src="/js/css.js"></script>
<script type="text/javascript" src="/js/dom.js"></script>
<script type="text/javascript" src="/js/p2p.js"></script>
<script type="text/javascript">

	function init() {

		// DOM

		var targets = {};

		function target(id) {
			
			let container;
			if (!id) {
				container = targets.last;
				if (container) return container;
			}
			container = document.getElementById(id);
 			targets.last = container;
			return container;
		}
		
		// CSS

		function getOrCreateStyleSheet(id) {
			let sheet = !!id ? document.getElementById(id) : null;
			if (!sheet) {
				sheet = document.createElement('style');
				document.head.appendChild(sheet);
			}
			return sheet;
		}

		// $e(`div#id.onclick(snooze).width=50%.wide!.lineHeight="1.3".tall!`);

		function render(...csx) {
			const root = target('root');
			const node = gen(...csx);
			root.appendChild(node);
			const code = document.getElementById('code');

			
			return node;
		}

		debugger

		const pageTitle = render(`h1#id`, {}, 'Hello');
		const mainSubTitle = render('h2', {}, 'Main Panel')
		const rightSubtitle = render('h2', {}, 'Right panel')
		const mainPanel = render('div.tall.col.grow', {}, mainSubTitle);
		const rightPanel = render('div.tall.col', {}, rightSubtitle);
		const pageRow = render('div.fill.row', {}, [ mainPanel, rightPanel ]);
		const pageCol = render(`div.fill.col`, {}, pageRow);

		return;


		$e(`div#id.onclick(snooze).width=50%.wide!.lineHeight="1.3".tall!`);


		const testWithChild = $e(`div#id.onclick(snooze).width=50%.wide!.lineHeight="1.3".tall!`, {snooze: () => alert('Ach-ooo!')});
		target('root').appendChild(button);

		return
		
		// Example 1
		const items = [
			'London',
			'Tokyo',
			'New York',
		];

		
		target('root').appendChild($e('ul', items));

		// Example 2

		let goals = ['Finish code', 'Buy milk', 'Feed cat'];
    	let todos = $e('div.reminder', 
                 		$e('h1', 'To do'),
                 		$e('ol', goals),
						$e(`button.onclick(snooze)`, {snooze: () => alert('Ach-ooo!')}),
                 	);

		target('root').appendChild(todos);

		// Example 3



		

		// add some items
		for (let i = 0; i < items.length; i++) {
			const parent = target('root');
			const element = parseElement('h1', 'Hello Mars!');
			parent.appendChild(element);
		}

		// add some style rules

		const style = {
			'.fill': {
				position: 'absolute',
				top: 0,
				left: 0,
				right: 0,
				bottom: 0,
			}
		}

	}

	try {
		setTimeout(() => {
			init()
		}, 0);
	}
	catch(e) {
		debugger
	}

</script>

</html>